<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>R gridSVG Reverse d3 Data Bind with Lattice LIne</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width">
  <link rel="icon" type="image/png" href="favicon.ico">
  <style>
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
  </style>
  
<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.1.1/css/bootstrap.no-responsive.no-icons.min.css" rel="stylesheet">
<!-- <link rel="stylesheet" href="/css/bootstrap.min.css"> -->
<link  rel="stylesheet" 
    href="http://netdna.bootstrapcdn.com/font-awesome/2.0/css/font-awesome.css">
  <link rel="stylesheet" href="libraries/frameworks/bootstrap/css/bootstrap-responsive.min.css">
  
  <link rel="stylesheet" href="libraries/frameworks/bootstrap/css/main.css">
  <link rel="stylesheet" href="libraries/highlighters/prettify/css/twitter-bootstrap.css" />
  <script src="libraries/frameworks/bootstrap/js/vendor/modernizr-2.6.1-respond-1.1.0.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="libraries/frameworks/bootstrap/js/vendor/jquery-1.8.2.min.js"><\/script>')</script>
    <link rel=stylesheet href="http://fonts.googleapis.com/css?family=Raleway:300"></link>
<link rel=stylesheet href="http://fonts.googleapis.com/css?family=Oxygen"></link>

  <script src="http://d3js.org/d3.v3.js"></script>

</head>
<body>
   <!--[if lt IE 7]>
     <p class="chromeframe">You are using an outdated browser. 
       <a href="http://browsehappy.com/">Upgrade your browser today</a> or 
       <a href="http://www.google.com/chromeframe/?redirect=true"> 
         install Google Chrome Frame
       </a> to better experience this site.
    </p>
   <![endif]-->
   <!-- Ref: http://twitter.github.com/bootstrap/examples/hero.html -->
   
    <div class="container">
      
<p><style>
  body{
    font-family: &#39;Oxygen&#39;, sans-serif;
    font-size: 16px;
    line-height: 24px;
  }</p>

<p>h1,h2,h3,h4 {
  font-family: &#39;Raleway&#39;, sans-serif;
}</p>

<p class='container'>{ width: 1000px; }</p>

<p>h3 {
  background-color: #D4DAEC;
    text-indent: 100px; 
}</p>

<p>h4 {
  text-indent: 100px;
}
</style></p>

<p><a href="https://github.com/timelyportfolio/gridSVG_d3_line"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a></p>

<h1>gridSVG Data Binding with a Lattice Line</h1>

<p>In <a href="http://timelyportfolio.blogspot.com/2013/08/gridsvganother-glue-for-r-to-svg.html">I Want ggplot2/lattice and d3 (gridSVGâ€“The Glue)</a> I demonstrated a trick I call &quot;a d3 reverse data bind&quot; on a ggplot2 scatterplot graph.  I discovered that lines are slightly more difficult to reverse data bind with d3.  <em>As an example of how this can be done without d3, see <a href="https://www.stat.auckland.ac.nz/%7Epaul/gridSVG/logoplot.svg">Paul Murrell&#39;s example</a>.</em>  Let&#39;s look at the extra steps needed to make it happen on a line chart from the <a href="http://news.research.stlouisfed.org/2013/07/58000-main-economic-indicators-mei-from-the-oecd-added-to-fred/">OECD data recently added to FRED</a>.  Retail Trade Sales: Passenger Car Registrations for Greece (SLRTCR03GRA657S) seems like something interesting.</p>

<pre><code class="r">#get the latest version of gridSVG
#install.packages(&quot;gridSVG&quot;, repos=&quot;http://R-Forge.R-project.org&quot;)

require(latticeExtra)
require(gridSVG)
require(quantmod)

#get data from FRED
greekCars &lt;- na.omit(
  getSymbols(&quot;SLRTCR03GRA657S&quot;, src=&quot;FRED&quot;, auto.assign=F)
)
</code></pre>

<h3>Draw Our Line Graph with Lattice</h3>

<p>Let&#39;s use <code>lattice</code> this time instead of <code>ggplot2</code>.  We will draw a basic line graph to keep it simple.</p>

<pre><code class="r">p1 &lt;- xyplot(
  greekCars,
  par.settings = theEconomist.theme(
    box = &quot;transparent&quot;
  ),
  lattice.options = theEconomist.opts(),
  scales = list(y = list(rot=0)),
  xlab = NULL,
  main = &quot;Car Registrations for Greece (data source: FRED) &quot;
)
p1
</code></pre>

<p><img src="assets/fig/unnamed-chunk-3.png" alt="plot of chunk unnamed-chunk-3"> </p>

<h3>Export to SVG</h3>

<p>Now that we have our graph, we will need to export it to SVG with <code>grid.export</code>.  When we supply <code>NULL</code> or <code>&quot;&quot;</code> to <code>grid.export</code>, we can get the SVG without saving as a file.</p>

<pre><code class="r">p1
oursvg &lt;- grid.export(&quot;&quot;)

cat(saveXML(oursvg$svg))
</code></pre>

<p><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="720px" height="288px" viewBox="0 0 720 288" version="1.1">
  <metadata xmlns:gridsvg="http://www.stat.auckland.ac.nz/~paul/R/gridSVG/">
    <gridsvg:generator name="gridSVG" version="1.3-0" time="2013-08-08 14:59:23"/>
    <gridsvg:argument name="name" value=""/>
    <gridsvg:argument name="exportCoords" value="none"/>
    <gridsvg:argument name="exportMappings" value="none"/>
    <gridsvg:argument name="exportJS" value="none"/>
    <gridsvg:argument name="res" value="72"/>
    <gridsvg:argument name="prefix" value=""/>
    <gridsvg:argument name="addClasses" value="FALSE"/>
    <gridsvg:argument name="indent" value="TRUE"/>
    <gridsvg:argument name="htmlWrapper" value="FALSE"/>
    <gridsvg:argument name="usePaths" value="vpPaths"/>
    <gridsvg:argument name="uniqueNames" value="TRUE"/>
    <gridsvg:separator name="id.sep" value="."/>
    <gridsvg:separator name="gPath.sep" value="::"/>
    <gridsvg:separator name="vpPath.sep" value="::"/>
  </metadata>
  <g transform="translate(0, 288) scale(1, -1)">
    <g id="gridSVG" fill="none" stroke="rgb(0,0,0)" stroke-dasharray="none" stroke-width="0.75" font-size="12" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" opacity="1" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="0" font-weight="normal" font-style="normal">
      <g id="plot_01.background.1">
        <rect id="plot_01.background.1.1" x="0" y="0" width="720" height="288" fill="none" stroke="none" stroke-opacity="0" fill-opacity="0"/>
      </g>
      <g id="plot_01.toplevel.vp.1" font-size="12">
        <g id="plot_01.toplevel.vp::plot_01.main.vp.1">
          <g id="plot_01.main.1">
            <g id="plot_01.main.1.1" transform="translate(14.17, 276.97)" stroke-width="0.1">
              <g id="plot_01.main.1.1.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.main.1.1.text" text-anchor="start" opacity="1" stroke="rgb(0,0,0)" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="14.4" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.main.1.1.tspan.1" dy="5.03" x="0">Car Registrations for Greece (data source: FRED) </tspan>
                </text>
              </g>
            </g>
          </g>
        </g>
        <g id="plot_01.toplevel.vp::plot_01.figure.vp.1"/>
        <defs>
          <clipPath id="plot_01.toplevel.vp::plot_01.panel.1.1.vp.1.clipPath">
            <rect x="45.97" y="42.19" width="590.03" height="200.75" fill="none" stroke="none"/>
          </clipPath>
        </defs>
        <g id="plot_01.toplevel.vp::plot_01.panel.1.1.vp.1" clip-path="url(#plot_01.toplevel.vp::plot_01.panel.1.1.vp.1.clipPath)"/>
        <g id="plot_01.toplevel.vp::plot_01.strip.1.1.off.vp.1"/>
        <g id="plot_01.toplevel.vp::plot_01.strip.left.1.1.off.vp.1"/>
        <g id="plot_01.toplevel.vp::plot_01.panel.1.1.off.vp.1">
          <g id="plot_01.ticks.bottom.panel.1.1.1">
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.1" points="108.73,42.19 108.73,36.52" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.2" points="234.26,42.19 234.26,36.52" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.3" points="359.82,42.19 359.82,36.52" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.4" points="485.35,42.19 485.35,36.52" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.5" points="610.91,42.19 610.91,36.52" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.6" points="58.51,42.19 58.51,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.7" points="83.61,42.19 83.61,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.8" points="133.82,42.19 133.82,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.9" points="158.95,42.19 158.95,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.10" points="184.04,42.19 184.04,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.11" points="209.17,42.19 209.17,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.12" points="259.38,42.19 259.38,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.13" points="284.48,42.19 284.48,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.14" points="309.6,42.19 309.6,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.15" points="334.69,42.19 334.69,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.16" points="384.91,42.19 384.91,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.17" points="410.04,42.19 410.04,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.18" points="435.13,42.19 435.13,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.19" points="460.26,42.19 460.26,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.20" points="510.47,42.19 510.47,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.21" points="535.56,42.19 535.56,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.22" points="560.69,42.19 560.69,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.23" points="585.78,42.19 585.78,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.ticks.bottom.panel.1.1.1.24" points="636,42.19 636,39.35" stroke="rgb(0,0,0)" opacity="1" stroke-dasharray="none" stroke-width="0.75" stroke-opacity="1" fill="none"/>
          </g>
          <g id="plot_01.ticklabels.bottom.panel.1.1.1">
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.1" transform="translate(108.73, 30.85)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.1.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.1.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.1.tspan.1" dy="7.18" x="0">1970</tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.2" transform="translate(234.26, 30.85)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.2.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.2.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.2.tspan.1" dy="7.18" x="0">1980</tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.3" transform="translate(359.82, 30.85)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.3.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.3.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.3.tspan.1" dy="7.18" x="0">1990</tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.4" transform="translate(485.35, 30.85)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.4.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.4.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.4.tspan.1" dy="7.18" x="0">2000</tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.5" transform="translate(610.91, 30.85)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.5.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.5.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.5.tspan.1" dy="7.18" x="0">2010</tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.6" transform="translate(58.51, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.6.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.6.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.6.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.7" transform="translate(83.61, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.7.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.7.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.7.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.8" transform="translate(133.82, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.8.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.8.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.8.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.9" transform="translate(158.95, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.9.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.9.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.9.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.10" transform="translate(184.04, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.10.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.10.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.10.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.11" transform="translate(209.17, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.11.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.11.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.11.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.12" transform="translate(259.38, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.12.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.12.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.12.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.13" transform="translate(284.48, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.13.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.13.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.13.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.14" transform="translate(309.6, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.14.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.14.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.14.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.15" transform="translate(334.69, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.15.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.15.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.15.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.16" transform="translate(384.91, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.16.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.16.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.16.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.17" transform="translate(410.04, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.17.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.17.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.17.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.18" transform="translate(435.13, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.18.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.18.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.18.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.19" transform="translate(460.26, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.19.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.19.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.19.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.20" transform="translate(510.47, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.20.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.20.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.20.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.21" transform="translate(535.56, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.21.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.21.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.21.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.22" transform="translate(560.69, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.22.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.22.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.22.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.23" transform="translate(585.78, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.23.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.23.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.23.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.bottom.panel.1.1.1.24" transform="translate(636, 33.68)" stroke-width="0.1">
              <g id="plot_01.ticklabels.bottom.panel.1.1.1.24.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.bottom.panel.1.1.1.24.text" text-anchor="middle" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.bottom.panel.1.1.1.24.tspan.1" dy="7.18" x="0"> </tspan>
                </text>
              </g>
            </g>
          </g>
          <g id="plot_01.ticklabels.right.panel.1.1.1">
            <g id="plot_01.ticklabels.right.panel.1.1.1.1" transform="translate(641.67, 67.26)" stroke-width="0.1">
              <g id="plot_01.ticklabels.right.panel.1.1.1.1.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.right.panel.1.1.1.1.text" text-anchor="start" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.right.panel.1.1.1.1.tspan.1" dy="3.59" x="0">-40</tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.right.panel.1.1.1.2" transform="translate(641.67, 97.76)" stroke-width="0.1">
              <g id="plot_01.ticklabels.right.panel.1.1.1.2.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.right.panel.1.1.1.2.text" text-anchor="start" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.right.panel.1.1.1.2.tspan.1" dy="3.59" x="0">-20</tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.right.panel.1.1.1.3" transform="translate(641.67, 128.25)" stroke-width="0.1">
              <g id="plot_01.ticklabels.right.panel.1.1.1.3.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.right.panel.1.1.1.3.text" text-anchor="start" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.right.panel.1.1.1.3.tspan.1" dy="3.59" x="0">0</tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.right.panel.1.1.1.4" transform="translate(641.67, 158.74)" stroke-width="0.1">
              <g id="plot_01.ticklabels.right.panel.1.1.1.4.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.right.panel.1.1.1.4.text" text-anchor="start" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.right.panel.1.1.1.4.tspan.1" dy="3.59" x="0">20</tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.right.panel.1.1.1.5" transform="translate(641.67, 189.24)" stroke-width="0.1">
              <g id="plot_01.ticklabels.right.panel.1.1.1.5.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.right.panel.1.1.1.5.text" text-anchor="start" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.right.panel.1.1.1.5.tspan.1" dy="3.59" x="0">40</tspan>
                </text>
              </g>
            </g>
            <g id="plot_01.ticklabels.right.panel.1.1.1.6" transform="translate(641.67, 219.73)" stroke-width="0.1">
              <g id="plot_01.ticklabels.right.panel.1.1.1.6.scale" transform="scale(1, -1)">
                <text x="0" y="0" id="plot_01.ticklabels.right.panel.1.1.1.6.text" text-anchor="start" stroke="rgb(0,0,0)" opacity="1" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-size="9.6" font-weight="normal" font-style="normal">
                  <tspan id="plot_01.ticklabels.right.panel.1.1.1.6.tspan.1" dy="3.59" x="0">60</tspan>
                </text>
              </g>
            </g>
          </g>
          <g id="plot_01.abline.h.panel.1.1.1">
            <polyline id="plot_01.abline.h.panel.1.1.1.1" points="45.97,67.26 636,67.26" stroke="rgb(170,170,170)" stroke-dasharray="none" stroke-width="1.31" opacity="1" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.abline.h.panel.1.1.1.2" points="45.97,97.76 636,97.76" stroke="rgb(170,170,170)" stroke-dasharray="none" stroke-width="1.31" opacity="1" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.abline.h.panel.1.1.1.3" points="45.97,128.25 636,128.25" stroke="rgb(170,170,170)" stroke-dasharray="none" stroke-width="1.31" opacity="1" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.abline.h.panel.1.1.1.4" points="45.97,158.74 636,158.74" stroke="rgb(170,170,170)" stroke-dasharray="none" stroke-width="1.31" opacity="1" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.abline.h.panel.1.1.1.5" points="45.97,189.24 636,189.24" stroke="rgb(170,170,170)" stroke-dasharray="none" stroke-width="1.31" opacity="1" stroke-opacity="1" fill="none"/>
            <polyline id="plot_01.abline.h.panel.1.1.1.6" points="45.97,219.73 636,219.73" stroke="rgb(170,170,170)" stroke-dasharray="none" stroke-width="1.31" opacity="1" stroke-opacity="1" fill="none"/>
          </g>
          <g id="plot_01.abline.h.panel.1.1.2">
            <polyline id="plot_01.abline.h.panel.1.1.2.1" points="45.97,42.19 636,42.19" stroke="rgb(0,0,0)" stroke-dasharray="none" stroke-width="1.13" opacity="1" stroke-opacity="1" fill="none"/>
          </g>
        </g>
        <defs>
          <clipPath id="plot_01.toplevel.vp::plot_01.panel.1.1.vp.2.clipPath">
            <rect x="45.97" y="42.19" width="590.03" height="200.75" fill="none" stroke="none"/>
          </clipPath>
        </defs>
        <g id="plot_01.toplevel.vp::plot_01.panel.1.1.vp.2" clip-path="url(#plot_01.toplevel.vp::plot_01.panel.1.1.vp.2.clipPath)">
          <g id="plot_01.xyplot.lines.group.1.panel.1.1.1">
            <polyline id="plot_01.xyplot.lines.group.1.panel.1.1.1.1" points="45.97,203.37 71.06,149.18 83.61,143.37 96.19,130.44 108.73,167.25 121.28,152.39 133.82,137.3 146.4,147 158.95,91.84 171.49,242.94 184.04,159.66 196.62,209.79 209.17,152.92 221.71,90.68 234.26,42.19 246.84,175.76 259.38,231.18 271.93,100.54 284.48,149.99 297.06,169.92 309.6,109.78 322.15,93.37 334.69,132.08 347.27,180.93 359.82,173.21 372.37,179.32 384.91,153.93 397.49,90.62 410.04,91.74 422.58,148.06 435.13,143.82 447.71,148.28 460.26,144.27 472.8,198.31 485.35,152.7 497.93,117.42 510.47,121.74 523.02,126.22 535.56,152.54 548.14,121.1 560.69,129.3 573.24,134.84 585.78,116.78 598.36,101.96 610.91,72.2 623.45,84.68 636,65" stroke-dasharray="none" stroke="rgb(0,82,109)" stroke-width="1.88" opacity="1" stroke-opacity="1" fill="none"/>
          </g>
        </g>
        <g id="plot_01.toplevel.vp::plot_01.panel.1.1.off.vp.2">
          <g id="plot_01.border.panel.1.1.1">
            <rect id="plot_01.border.panel.1.1.1.1" x="45.97" y="42.19" width="590.03" height="200.75" stroke="none" stroke-dasharray="none" stroke-width="0.75" opacity="1" fill="none" stroke-opacity="0" fill-opacity="0"/>
          </g>
        </g>
        <g id="plot_01.toplevel.vp::plot_01..1"/>
      </g>
    </g>
  </g>
</svg></p>

<h3>Watch This Reverse Data Bind</h3>

<p>If we look at our line from the SVG, we see something like this.</p>

<p><img src="svgline.png" alt="Screenshot of SVG line points"></p>

<p>So we have our line, and the points are attributes which we can see by using d3.</p>

<pre><code>d3.select(&quot;[id*=&#39;xyplot.lines&#39;]&quot;).select(&quot;polyline&quot;).attr(&quot;points&quot;)
</code></pre>

<p>On the scatter plot, each point was its own little SVG element, and our data could be bound directly to it.  To bind data to our line, we will need to use d3 to create a new path/line or new points.  I think the new path/line method is more interesting, so I&#39;ll choose that route.  We will need to split the long string of points into separate coordinates.  I wrote a function (please don&#39;t be too critical) to do this and also add our R data while we are at it.</p>

<pre><code>function pointsToArray(points, data) {
  var pointsArray = new Array();

  pointsArray = points.match(/[^ ]+/g);

  pointsArray = pointsArray.map(
                function (d, i) {
                  return {
                    x: d.split(&quot;,&quot;)[0],
                    y: d.split(&quot;,&quot;)[1],
                    data: data[i].value
                  }
                }
            );

  return pointsArray;
}
</code></pre>

<script>
function pointsToArray(points, data) {
  var pointsArray = new Array();

  pointsArray = points.match(/[^ ]+/g);

  pointsArray = pointsArray.map(
                function (d, i) {
                  return {
                    x: d.split(",")[0],
                    y: d.split(",")[1],
                    data: data[i]
                  }
                }
            );

  return pointsArray;
}
</script>

<p>We will need to get the data from our R lattice plot.  I will eventually make this into a function.  The data for lattice plots falls into the <code>panel.args</code>.</p>

<pre><code class="r">cat(&#39;&lt;script&gt; ourdata=&#39;,
  rjson::toJSON(
    apply(
      data.frame(p1$panel.args),
      MARGIN=1,FUN=function(x)return(list(x))
    )
  ),
  &#39;&lt;/script&gt;&#39;
)
</code></pre>

<script> ourdata= [[{"x":"1965-01-01","y":" 49.2698","subscripts":" 1"}],[{"x":"1967-01-01","y":" 13.7243","subscripts":" 2"}],[{"x":"1968-01-01","y":"  9.9149","subscripts":" 3"}],[{"x":"1969-01-01","y":"  1.4336","subscripts":" 4"}],[{"x":"1970-01-01","y":" 25.5811","subscripts":" 5"}],[{"x":"1971-01-01","y":" 15.8342","subscripts":" 6"}],[{"x":"1972-01-01","y":"  5.9342","subscripts":" 7"}],[{"x":"1973-01-01","y":" 12.2950","subscripts":" 8"}],[{"x":"1974-01-01","y":"-23.8800","subscripts":" 9"}],[{"x":"1975-01-01","y":" 75.2202","subscripts":"10"}],[{"x":"1976-01-01","y":" 20.6033","subscripts":"11"}],[{"x":"1977-01-01","y":" 53.4760","subscripts":"12"}],[{"x":"1978-01-01","y":" 16.1821","subscripts":"13"}],[{"x":"1979-01-01","y":"-24.6417","subscripts":"14"}],[{"x":"1980-01-01","y":"-56.4442","subscripts":"15"}],[{"x":"1981-01-01","y":" 31.1608","subscripts":"16"}],[{"x":"1982-01-01","y":" 67.5085","subscripts":"17"}],[{"x":"1983-01-01","y":"-18.1720","subscripts":"18"}],[{"x":"1984-01-01","y":" 14.2551","subscripts":"19"}],[{"x":"1985-01-01","y":" 27.3314","subscripts":"20"}],[{"x":"1986-01-01","y":"-12.1113","subscripts":"21"}],[{"x":"1987-01-01","y":"-22.8746","subscripts":"22"}],[{"x":"1988-01-01","y":"  2.5115","subscripts":"23"}],[{"x":"1989-01-01","y":" 34.5476","subscripts":"24"}],[{"x":"1990-01-01","y":" 29.4906","subscripts":"25"}],[{"x":"1991-01-01","y":" 33.4939","subscripts":"26"}],[{"x":"1992-01-01","y":" 16.8436","subscripts":"27"}],[{"x":"1993-01-01","y":"-24.6821","subscripts":"28"}],[{"x":"1994-01-01","y":"-23.9460","subscripts":"29"}],[{"x":"1995-01-01","y":" 12.9943","subscripts":"30"}],[{"x":"1996-01-01","y":" 10.2111","subscripts":"31"}],[{"x":"1997-01-01","y":" 13.1350","subscripts":"32"}],[{"x":"1998-01-01","y":" 10.5044","subscripts":"33"}],[{"x":"1999-01-01","y":" 45.9525","subscripts":"34"}],[{"x":"2000-01-01","y":" 16.0343","subscripts":"35"}],[{"x":"2001-01-01","y":" -7.1041","subscripts":"36"}],[{"x":"2002-01-01","y":" -4.2684","subscripts":"37"}],[{"x":"2003-01-01","y":" -1.3319","subscripts":"38"}],[{"x":"2004-01-01","y":" 15.9306","subscripts":"39"}],[{"x":"2005-01-01","y":" -4.6885","subscripts":"40"}],[{"x":"2006-01-01","y":"  0.6897","subscripts":"41"}],[{"x":"2007-01-01","y":"  4.3252","subscripts":"42"}],[{"x":"2008-01-01","y":" -7.5217","subscripts":"43"}],[{"x":"2009-01-01","y":"-17.2433","subscripts":"44"}],[{"x":"2010-01-01","y":"-36.7611","subscripts":"45"}],[{"x":"2011-01-01","y":"-28.5758","subscripts":"46"}],[{"x":"2012-01-01","y":"-41.4828","subscripts":"47"}]] </script>

<p>Then we will use the same function from our ggplot2 scatter post.</p>

<pre><code class="r">cat(
  &#39;&lt;script&gt; dataToBind = &#39;,
  &#39;d3.entries(ourdata.map(function(d,i) {return d[0]}))&#39;,
  &#39;&lt;/script&gt;&#39;
)
</code></pre>

<script> dataToBind =  d3.entries(ourdata.map(function(d,i) {return d[0]})) </script>

<p>Then we will use <code>d3.svg.line()</code> to draw an overlay line with the points and data from our function.  The <code>interpolate(&quot;linear&quot;)</code> will insure that the lines matches exactly.  If you feel like experimenting, try <code>interpolate(&quot;basis&quot;)</code> to see the difference.  We will also specify `attr(&quot;stroke&quot;,&quot;white&quot;) so that we will see our new line.  However, in future posts I most likely will make our line invisible.</p>

<pre><code>var svg = d3.select(&quot;#gridSVG&quot;);
var line = d3.svg.line()
            .x(function (d) { return +d.x; })
            .y(function (d) { return +d.y; })
            .interpolate(&quot;linear&quot;);
var g = d3.select(&quot;[id*=&#39;xyplot.lines&#39;]&quot;)

g.append(&quot;path&quot;)
  .datum(pointsToArray(g.select(&quot;polyline&quot;).attr(&quot;points&quot;), dataToBind))
  .attr(&quot;d&quot;, line)
  .attr(&quot;stroke&quot;,&quot;white&quot;);
</code></pre>

<script>
var svg = d3.select("#gridSVG");
var line = d3.svg.line()
            .x(function (d) { return +d.x; })
            .y(function (d) { return +d.y; })
            .interpolate("linear");
var g = d3.select("[id*='xyplot.lines']")

g.append("path")
  .datum(pointsToArray(g.select("polyline").attr("points"), dataToBind))
  .attr("d", line)
  .attr("stroke","white");
</script>

<p>With a d3 data-bound line, we can do things like the mouseover in <a href="http://bl.ocks.org/mbostock/3902569">this example from Mike Bostock</a>.  Let&#39;s grab the code and make some minor adjustments to achieve this.  Set up some SVG elements to house our tooltip.</p>

<pre><code>var focus = svg.append(&quot;g&quot;)
    .attr(&quot;class&quot;, &quot;focus&quot;)
    .style(&quot;display&quot;, &quot;none&quot;)
    .attr(&quot;stroke&quot;,&quot;rgb(0,82,109)&quot;);

focus.append(&quot;circle&quot;)
    .attr(&quot;r&quot;, 4.5);

focus.append(&quot;text&quot;)
    .attr(&quot;id&quot;,&quot;focusx&quot;)
    .attr(&quot;x&quot;, 9)
    .attr(&quot;dy&quot;, &quot;.35em&quot;)
    .attr(&quot;font-size&quot;,12)
    .attr(&quot;font-color&quot;,&quot;black&quot;)
    .attr(&quot;fill&quot;,&quot;rgb(0,82,109)&quot;)
    .attr(&quot;fill-opacity&quot;,1)
    .attr(&quot;stroke&quot;,&quot;rgb(0,82,109)&quot;)
    .attr(&quot;transform&quot;,&quot;scale(1,-1)&quot;);

focus.append(&quot;text&quot;)
    .attr(&quot;id&quot;,&quot;focusy&quot;)
    .attr(&quot;x&quot;, 9)
    .attr(&quot;y&quot;,14)
    .attr(&quot;dy&quot;, &quot;.35em&quot;)
    .attr(&quot;font-size&quot;,12)
    .attr(&quot;fill-opacity&quot;,1)    
    .attr(&quot;transform&quot;,&quot;scale(1,-1)&quot;);
</code></pre>

<p>Set up a SVG rectangle to pick up mouse events.</p>

<pre><code>svg.append(&quot;rect&quot;)
    .attr(&quot;class&quot;, &quot;overlay&quot;)
    .attr(&quot;x&quot;, d3.selectAll(&quot;defs [id*=&#39;plot_01.panel.1.1.vp.2.clipPath&#39;] rect&quot;).attr(&quot;x&quot;))
    .attr(&quot;y&quot;, d3.selectAll(&quot;defs [id*=&#39;plot_01.panel.1.1.vp.2.clipPath&#39;] rect&quot;).attr(&quot;y&quot;))
    .attr(&quot;width&quot;, d3.selectAll(&quot;defs [id*=&#39;plot_01.panel.1.1.vp.2.clipPath&#39;] rect&quot;).attr(&quot;width&quot;))
    .attr(&quot;height&quot;, d3.selectAll(&quot;defs [id*=&#39;plot_01.panel.1.1.vp.2.clipPath&#39;] rect&quot;).attr(&quot;height&quot;))
    .attr(&quot;fill&quot;, &quot;none&quot;)
    .attr(&quot;stroke&quot;, &quot;none&quot;)
    .attr(&quot;pointer-events&quot;,&quot;all&quot;)
    .on(&quot;mouseover&quot;, function() { focus.style(&quot;display&quot;, null); })
    .on(&quot;mouseout&quot;, function() { focus.style(&quot;display&quot;, &quot;none&quot;); })
    .on(&quot;mousemove&quot;, mousemove);
</code></pre>

<p>Use d3&#39;s <code>d3.bisector</code> to determine the position of our mouse and translate this position to the appropriate point and data.  We will then move our <code>focus</code> element from above to the found point.  Also, since we have d3 we will use its <code>d3.format</code> to give us percent number, and our color will change based on a negative or positive value.</p>

<pre><code>var bisectX = d3.bisector(function (d) { return +d.x; }).left;

function mousemove() {
  var x0 = d3.mouse(this)[0];
  var i = bisectX( g.select(&quot;path&quot;).datum(), x0, 1);
  var d;
  d = g.select(&quot;path&quot;).datum()[i];
  focus.attr(&quot;transform&quot;, &quot;translate(&quot; + d.x + &quot;,&quot; + d.y + &quot;)&quot;);
  focus.select(&quot;#focusx&quot;)
    .text(d.data.value.x);
  focus.select(&quot;#focusy&quot;)
    .text(d3.format(&quot;.2%&quot;)(+d.data.value.y/100))
    .attr(&quot;fill&quot;,+d.data.value.y&gt;0?&quot;black&quot;:&quot;red&quot;)
    .attr(&quot;stroke&quot;,+d.data.value.y&gt;0?&quot;black&quot;:&quot;red&quot;);
}
</code></pre>

<script>
var focus = svg.append("g")
    .attr("class", "focus")
    .style("display", "none")
    .attr("stroke","rgb(0,82,109)");

focus.append("circle")
    .attr("r", 4.5);

focus.append("text")
    .attr("id","focusx")
    .attr("x", 9)
    .attr("dy", ".35em")
    .attr("font-size",12)
    .attr("font-color","black")
    .attr("fill","rgb(0,82,109)")
    .attr("fill-opacity",1)
    .attr("stroke","rgb(0,82,109)")
    .attr("transform","scale(1,-1)");
    
focus.append("text")
    .attr("id","focusy")
    .attr("x", 9)
    .attr("y",14)
    .attr("dy", ".35em")
    .attr("font-size",12)
    .attr("fill-opacity",1)    
    .attr("transform","scale(1,-1)");

svg.append("rect")
    .attr("class", "overlay")
    .attr("x", d3.selectAll("defs [id*='plot_01.panel.1.1.vp.2.clipPath'] rect").attr("x"))
    .attr("y", d3.selectAll("defs [id*='plot_01.panel.1.1.vp.2.clipPath'] rect").attr("y"))
    .attr("width", d3.selectAll("defs [id*='plot_01.panel.1.1.vp.2.clipPath'] rect").attr("width"))
    .attr("height", d3.selectAll("defs [id*='plot_01.panel.1.1.vp.2.clipPath'] rect").attr("height"))
    .attr("fill", "none")
    .attr("stroke", "none")
    .attr("pointer-events","all")
    .on("mouseover", function() { focus.style("display", null); })
    .on("mouseout", function() { focus.style("display", "none"); })
    .on("mousemove", mousemove);

var bisectX = d3.bisector(function (d) { return +d.x; }).left;

function mousemove() {
  var x0 = d3.mouse(this)[0];
  var i = bisectX( g.select("path").datum(), x0, 1);
  var d;
  d = g.select("path").datum()[i];
  focus.attr("transform", "translate(" + d.x + "," + d.y + ")");
  focus.select("#focusx")
    .text(d.data.value.x);
  focus.select("#focusy")
    .text(d3.format(".2%")(+d.data.value.y/100))
    .attr("fill",+d.data.value.y>0?"black":"red")
    .attr("stroke",+d.data.value.y>0?"black":"red");
}
</script>

    </div>
        
</body>
  <script src="libraries/frameworks/bootstrap/js/vendor/bootstrap.min.js"></script>
  <script src="libraries/frameworks/bootstrap/js/plugins.js"></script>
  <script src="libraries/frameworks/bootstrap/js/main.js"></script>
  <!-- Load Javascripts for Widgets -->
  
  <!-- Google Prettify -->
  <script src="http://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js"></script>
  <script src='libraries/highlighters/prettify/js/lang-r.js'></script>
  <script>
    var pres = document.getElementsByTagName("pre");
    for (var i=0; i < pres.length; ++i) {
      pres[i].className = "prettyprint linenums";
    }
    prettyPrint();
  </script>
  <!-- End Google Prettify --> 
  </html>